<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>RDS tutorial • RDS</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/yeti/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="RDS tutorial">
<meta property="og:description" content="RDS">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">RDS</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.9-2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/How-to.html">Tutorial How to start</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/ifellows/RDS/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="RDS-tut_files/accessible-code-block-0.0.1/empty-anchor.js"></script><script src="RDS-tut_files/htmlwidgets-1.5.3/htmlwidgets.js"></script><script src="RDS-tut_files/jquery-3.5.1/jquery.min.js"></script><link href="RDS-tut_files/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="RDS-tut_files/datatables-binding-0.17/datatables.js"></script><link href="RDS-tut_files/dt-core-1.10.20/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="RDS-tut_files/dt-core-1.10.20/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="RDS-tut_files/dt-core-1.10.20/js/jquery.dataTables.min.js"></script><link href="RDS-tut_files/crosstalk-1.1.1/css/crosstalk.css" rel="stylesheet">
<script src="RDS-tut_files/crosstalk-1.1.1/js/crosstalk.min.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>RDS tutorial</h1>
                        <h4 class="author">Americas DIMA</h4>
            
            <h4 class="date">09/12/2020</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/ifellows/RDS/blob/master/vignettes/RDS-tut.Rmd"><code>vignettes/RDS-tut.Rmd</code></a></small>
      <div class="hidden name"><code>RDS-tut.Rmd</code></div>

    </div>

    
    
<div id="intro" class="section level1">
<h1 class="hasAnchor">
<a href="#intro" class="anchor"></a>Intro</h1>
<p>Respondent Driven Sampling (RDS) is an improvement upon snowball sampling that tries to mitigate the effect of selection biases introduced into the sampling process due to the non-probabilistic selection of participants by applying smart weighting and estimation procedures based on information provided by the respondents. The calculations for those, however, are a bit cumbersome which necessitated the use of <a href="http://www.deducer.org/pmwiki/pmwiki.php?n=Main.RDSAnalyst">specialized software</a> in the past for the analysis of RDS survey data. In this brief tutorial, we’ll demonstrate how similar analysis could be undertaken using the R <a href="https://cran.r-project.org/web/packages/RDS/index.html"><code>RDS</code></a> package directly making the analysis more reproducible and less dependent on error-prone point-and-click software.</p>
</div>
<div id="data-collection" class="section level1">
<h1 class="hasAnchor">
<a href="#data-collection" class="anchor"></a>Data Collection</h1>
<p>To quote from the <a href="http://www.respondentdrivensampling.org/">RDS homepage</a>:</p>
<blockquote>
<p>While data requirements for RDS analysis are minimal, there are three pieces of information which are essential for analysis (RDS analysis CANNOT BE PERFORMED without these fields for each respondent):</p>
<ul>
<li>
<strong>Personal Network Size (Degree)</strong> - Number of people the respondent knows within the target population.</li>
<li>
<strong>Respondent’s Serial Number</strong> - Serial number of the coupon the respondent was recruited with.</li>
<li>
<strong>Respondent’s Recruiting Serial Numbers</strong> - Serial numbers from the coupons the respondent is given to recruit others.</li>
</ul>
</blockquote>
<p>For illustration purposes, we’ll use a subset of the New York jazz players dataset (<a href="https://github.com/galalH/RDS/blob/master/inst/extdata/nyjazz.csv">nyjazz.csv</a>) from <a href="http://www.respondentdrivensampling.org/reports/Heckathorn.pdf">Heckathon’s early research into the subject</a>.</p>
<p>If Heckathon had used KoBo for data collection, their xlsform would’ve looked similar to this:</p>
<ul>
<li>Survey sheet</li>
</ul>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">xlsform.survey</span> <span class="op">&lt;-</span> <span class="fu">read_csv</span><span class="op">(</span><span class="st">"https://gist.githubusercontent.com/galalH/b7d8bed9192626da2631dd59c1b46d5f/raw/1e118c23597cacbdf04dee54ec299805fcd8bd7b/rds-survey.csv"</span><span class="op">)</span>
<span class="fu">DT</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/DT/man/datatable.html">datatable</a></span><span class="op">(</span><span class="va">xlsform.survey</span>, options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>pageLength <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">xlsform.survey</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div id="htmlwidget-3f680f3d9158288ba615" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-3f680f3d9158288ba615">{"x":{"filter":"none","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22"],["integer","integer","calculate","calculate","calculate","calculate","calculate","calculate","calculate","note","note","note","note","note","note","note","select_one gender","select_one race","integer","integer","select_one yn","select_one yn"],["network.size","own.coupon","coupon.1","coupon.2","coupon.3","coupon.4","coupon.5","coupon.6","coupon.7","coupon.1.note","coupon.2.note","coupon.3.note","coupon.4.note","coupon.5.note","coupon.6.note","coupon.7.note","Gender.MF.","Race.WBO.","Age","Degree","Airplay.yn.","Union.yn."],["Number of people you know within the target population","Serial number of the coupon you were recruited with",null,null,null,null,null,null,null,"This is a coupon for you to recruit others: ${coupon.1}\nPlease note that each coupon should be given to one person only.","This is a coupon for you to recruit others: ${coupon.2}\nPlease note that each coupon should be given to one person only.","This is a coupon for you to recruit others: ${coupon.3}\nPlease note that each coupon should be given to one person only.","This is a coupon for you to recruit others: ${coupon.4}\nPlease note that each coupon should be given to one person only.","This is a coupon for you to recruit others: ${coupon.5}\nPlease note that each coupon should be given to one person only.","This is a coupon for you to recruit others: ${coupon.6}\nPlease note that each coupon should be given to one person only.","This is a coupon for you to recruit others: ${coupon.7}\nPlease note that each coupon should be given to one person only.","Gender","Race","Age","Degree","Airplay","Union"],[null,null,"100000000*once(random())","100000000*once(random())","100000000*once(random())","100000000*once(random())","100000000*once(random())","100000000*once(random())","100000000*once(random())",null,null,null,null,null,null,null,null,null,null,null,null,null]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>type<\/th>\n      <th>name<\/th>\n      <th>label<\/th>\n      <th>calculcate<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":22,"order":[],"autoWidth":false,"orderClasses":false,"columnDefs":[{"orderable":false,"targets":0}],"lengthMenu":[10,22,25,50,100]}},"evals":[],"jsHooks":[]}</script><ul>
<li>Choices sheet</li>
</ul>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">xlsform.choices</span> <span class="op">&lt;-</span> <span class="fu">read_csv</span><span class="op">(</span><span class="st">"https://gist.githubusercontent.com/galalH/b7d8bed9192626da2631dd59c1b46d5f/raw/1e118c23597cacbdf04dee54ec299805fcd8bd7b/rds-choices.csv"</span><span class="op">)</span> 
<span class="fu">DT</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/DT/man/datatable.html">datatable</a></span><span class="op">(</span><span class="va">xlsform.choices</span><span class="op">)</span></code></pre></div>
<div id="htmlwidget-b42ace4c7d5dea9c170a" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-b42ace4c7d5dea9c170a">{"x":{"filter":"none","data":[["1","2","3","4","5","6","7"],["gender","gender","race","race","race","yn","yn"],[1,2,1,2,3,1,2],["Male","Female","White","Black","Other","Yes","No"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>list_name<\/th>\n      <th>name<\/th>\n      <th>label<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":2},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script><p>And here’s an overview of the collected data:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu">read_csv</span><span class="op">(</span><span class="st">"https://raw.githubusercontent.com/galalH/RDS/master/inst/extdata/nyjazz.csv"</span><span class="op">)</span>
<span class="co"># minor data cleaning</span>
<span class="va">data</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op">%&gt;%</span> <span class="fu">select</span><span class="op">(</span><span class="op">-</span><span class="va">X1</span><span class="op">)</span> <span class="co"># %&gt;% mutate(across(ends_with("."), as.factor))</span>
<span class="co"># encode variables</span>
<span class="va">data</span> <span class="op">&lt;-</span> 
  <span class="va">data</span> <span class="op">%&gt;%</span> 
  <span class="fu">mutate</span><span class="op">(</span>
    Gender.MF. <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Male"</span>, <span class="st">"Female"</span><span class="op">)</span><span class="op">[</span><span class="va">Gender.MF.</span><span class="op">]</span>,
    Race.WBO. <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"White"</span>, <span class="st">"Black"</span>, <span class="st">"Other"</span><span class="op">)</span><span class="op">[</span><span class="va">Race.WBO.</span><span class="op">]</span>,
    Airplay.yn. <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Yes"</span>, <span class="st">"No"</span><span class="op">)</span><span class="op">[</span><span class="va">Airplay.yn.</span><span class="op">]</span>,
    Union.yn. <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Yes"</span>, <span class="st">"No"</span><span class="op">)</span><span class="op">[</span><span class="va">Union.yn.</span><span class="op">]</span><span class="op">)</span>

<span class="fu">glimpse</span><span class="op">(</span><span class="va">data</span><span class="op">)</span></code></pre></div>
<pre><code>## Rows: 264
## Columns: 16
## $ id           &lt;dbl&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 1…
## $ network.size &lt;dbl&gt; 350, NA, 585, 400, 150, 100, 300, 700, 300, 200, 200, 30…
## $ own.coupon   &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, 14256002, 14250013, 1425…
## $ coupon.1     &lt;dbl&gt; 14250004, 14250007, 14250010, 14250025, 14250022, 142500…
## $ coupon.2     &lt;dbl&gt; 14250005, 14250008, 14250011, 14250026, 14250023, 142500…
## $ coupon.3     &lt;dbl&gt; 14250006, 14250009, 14250012, 14250027, 14250023, 142500…
## $ coupon.4     &lt;dbl&gt; 14256002, 14256003, 14256004, 14256009, 14256008, 142560…
## $ coupon.5     &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
## $ coupon.6     &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
## $ coupon.7     &lt;dbl&gt; 901, 902, 903, 904, 905, 906, 907, 908, 909, 9010, 9011,…
## $ Gender.MF.   &lt;chr&gt; "Male", "Male", "Female", "Female", "Male", "Male", "Mal…
## $ Race.WBO.    &lt;chr&gt; "White", "Black", "Other", "Black", "White", "Other", "B…
## $ Age          &lt;dbl&gt; 40, 64, 41, 77, 33, 31, 70, 49, 38, 37, 50, 41, 51, 46, …
## $ Degree       &lt;dbl&gt; 350, NA, 585, 400, 150, 100, 300, 700, 300, 200, 200, 30…
## $ Airplay.yn.  &lt;chr&gt; "Yes", "Yes", "Yes", NA, "Yes", "No", "Yes", "Yes", "Yes…
## $ Union.yn.    &lt;chr&gt; "Yes", "No", "No", "Yes", "No", "Yes", "Yes", "Yes", "No…</code></pre>
</div>
<div id="prepare-for-data-analysis" class="section level1">
<h1 class="hasAnchor">
<a href="#prepare-for-data-analysis" class="anchor"></a>Prepare for Data Analysis</h1>
<p>Before proceeding with the analysis, we first need to prepare the data in the format expected by the package. Usually that means adding a column with the id (=coupon number) of the person who recruited each respondent into the survey.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">data</span> <span class="op">&lt;-</span> 
  <span class="va">data</span> <span class="op">%&gt;%</span> 
  <span class="fu">mutate</span><span class="op">(</span>recruiter.coupon <span class="op">=</span> <span class="fu"><a href="../reference/rid.from.coupons.html">rid.from.coupons</a></span><span class="op">(</span><span class="va">data</span>,
                                             subject.coupon <span class="op">=</span> <span class="st">"own.coupon"</span>,
                                             coupon.variables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"coupon."</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">7</span><span class="op">)</span>,
                                             subject.id <span class="op">=</span> <span class="st">"id"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>Now we can pass our data-frame to <code>as.rds.dataframe()</code> which adds a bunch of attributes that tell other functions in the package where to find the relevant variables.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/as.rds.data.frame.html">as.rds.data.frame</a></span><span class="op">(</span><span class="va">data</span>,
                          id <span class="op">=</span> <span class="st">"id"</span>,
                          recruiter.id <span class="op">=</span> <span class="st">"recruiter.coupon"</span>,
                          network.size <span class="op">=</span> <span class="st">"network.size"</span>,
                          population.size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>min <span class="op">=</span> <span class="fl">8000</span>, mid <span class="op">=</span> <span class="fl">10000</span>, high <span class="op">=</span> <span class="fl">15000</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>The function also runs a number of validation checks to spot any issues with the data before letting you go any further. If you get an error here, make sure that you’ve passed the correct variables into the last two functions. Otherwise, it’s possible that there were errors on the part of the respondents when filling in their coupon numbers which broke the deriviation of recruiters from respondent coupons. There’s no way to fix that apart from manually inspecting and editing the data, or throwing out the erroneous records. This is a limitation of how the coupon numbers are generated in KoBo.</p>
</div>
<div id="run-diagnostics" class="section level1">
<h1 class="hasAnchor">
<a href="#run-diagnostics" class="anchor"></a>Run Diagnostics</h1>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></code></pre></div>
<p><img src="RDS-tut_files/figure-html/recruitment-tree-1.png" width="700" style="display: block; margin: auto;"></p>
<p>Questions to ask when diagnosing recruitment trees:</p>
<ul>
<li>Are the chains long?</li>
<li>Do most of the subjects come from the same seed?</li>
<li>What’s the degree of homophily in the process?</li>
</ul>
<p>Answering that last one requires producing multiple variants of the recruitment tree where vertices are colored according to different demographic variables to measure if “likes recurit likes”. Here’s an example using the race variable in the dataset which shows that white people almost exclusively recruit other white respondents:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">data</span>, vertex.color <span class="op">=</span> <span class="st">"Race.WBO."</span><span class="op">)</span></code></pre></div>
<p><img src="RDS-tut_files/figure-html/homophily-viz-1.png" width="700" style="display: block; margin: auto;"></p>
<p>Underneath the hood, <code><a href="https://rdrr.io/r/graphics/plot.default.html">plot()</a></code> calls <code><a href="../reference/reingold.tilford.plot.html">reingold.tilford.plot()</a></code> which allows for customizing the color, size, and labels of the vertices as desired. See the function documentation for more details and pass the arguments into <code><a href="https://rdrr.io/r/graphics/plot.default.html">plot()</a></code>.</p>
<p>There are five more plots to explore that could provide us insight into the recruitment process:</p>
<ul>
<li>Network Size by wave</li>
</ul>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">data</span>, plot.type <span class="op">=</span> <span class="st">"Network size by wave"</span><span class="op">)</span></code></pre></div>
<p><img src="RDS-tut_files/figure-html/unnamed-chunk-1-1.png" width="700" style="display: block; margin: auto;"></p>
<ul>
<li>Recruits by wave</li>
</ul>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">data</span>, plot.type <span class="op">=</span> <span class="st">"Recruits by wave"</span><span class="op">)</span></code></pre></div>
<p><img src="RDS-tut_files/figure-html/unnamed-chunk-2-1.png" width="700" style="display: block; margin: auto;"></p>
<ul>
<li>Recruits by Seeds</li>
</ul>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">data</span>, plot.type <span class="op">=</span> <span class="st">"Recruits per seed"</span><span class="op">)</span></code></pre></div>
<p><img src="RDS-tut_files/figure-html/unnamed-chunk-3-1.png" width="700" style="display: block; margin: auto;"></p>
<ul>
<li>Recruits by subject</li>
</ul>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">data</span>, plot.type <span class="op">=</span> <span class="st">"Recruits per subject"</span><span class="op">)</span></code></pre></div>
<p><img src="RDS-tut_files/figure-html/unnamed-chunk-4-1.png" width="700" style="display: block; margin: auto;"></p>
<p>Questions to ask when interpreting the charts:</p>
<ul>
<li>Does network size change over the course of sampling?</li>
<li>How many recruits are in each wave?</li>
<li>How many recruits originate from each seed?</li>
</ul>
</div>
<div id="analyze-data" class="section level1">
<h1 class="hasAnchor">
<a href="#analyze-data" class="anchor"></a>Analyze Data</h1>
<p>The <code>nyjazz</code> dataset comes with three control variables (age, gender, and race) and three outcome variables (degree, airplay, and union membership). Let’s say we were interested in estimating the proportion of jazz players who were union members:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">(</span><span class="va">est</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/RDS.bootstrap.intervals.html">RDS.bootstrap.intervals</a></span><span class="op">(</span><span class="va">data</span>, outcome.variable <span class="op">=</span> <span class="st">"Union.yn."</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## 
## Note: Using the data's mid population size estimate: N = 10000 
## Using 213 bootstrap samples.</code></pre>
<pre><code>## Gile's SS Estimate for Union.yn. 
##     Estimate (%)         95% Interval Design Effect Std. Error     N
## No          75.8 (   67.65,    83.78)          2.49       4.11   158
## Yes         24.2 (   16.22,    32.35)          2.49       4.11   105
##                                                          Total   263
## * Using population size estimate: 10000</code></pre>
<p>To convert that into a tidy format that we could use for further analysis and visualization:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">bsresult</span> <span class="op">&lt;-</span> <span class="fu">attr_getter</span><span class="op">(</span><span class="st">"bsresult"</span><span class="op">)</span>

<span class="va">est</span> <span class="op">&lt;-</span> 
  <span class="fu">left_join</span><span class="op">(</span>
    <span class="va">est</span> <span class="op">%&gt;%</span> <span class="fu">pluck</span><span class="op">(</span><span class="st">"estimate"</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">enframe</span><span class="op">(</span>name <span class="op">=</span> <span class="st">"level"</span>, value <span class="op">=</span> <span class="st">"est"</span><span class="op">)</span>,
    <span class="va">est</span> <span class="op">%&gt;%</span> <span class="fu">pluck</span><span class="op">(</span><span class="st">"interval"</span>, <span class="va">bsresult</span>, <span class="st">"se_estimate"</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">enframe</span><span class="op">(</span>name <span class="op">=</span> <span class="st">"level"</span>, value <span class="op">=</span> <span class="st">"se"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>And then we can plot it like any other dataset:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">est</span> <span class="op">%&gt;%</span> 
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span><span class="va">level</span>, <span class="va">est</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">geom_col</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_errorbar</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">est</span><span class="op">-</span><span class="va">se</span>, ymax <span class="op">=</span> <span class="va">est</span><span class="op">+</span><span class="va">se</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">scale_y_continuous</span><span class="op">(</span>labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="va"><a href="https://scales.r-lib.org//reference/label_percent.html">percent</a></span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme_minimal</span><span class="op">(</span>base_family <span class="op">=</span> <span class="st">"Lato"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="cn">NULL</span>, y <span class="op">=</span> <span class="cn">NULL</span>, title <span class="op">=</span> <span class="st">"Union Membership of NYC Jazz Players"</span><span class="op">)</span></code></pre></div>
<p><img src="RDS-tut_files/figure-html/est-plot-1.png" width="700" style="display: block; margin: auto;"></p>
<p>Or if we wanted to compare union membership by gender:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">(</span><span class="va">est</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bootstrap.contingency.test.html">bootstrap.contingency.test</a></span><span class="op">(</span><span class="va">data</span>, row.var <span class="op">=</span> <span class="st">"Gender.MF."</span>, col.var <span class="op">=</span> <span class="st">"Union.yn."</span>, table.only <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>##               No      Yes
## Female  45.95878 11.90970
## Male   148.84615 57.28537</code></pre>
<p>The result is in absolute counts. To convert it to percentages, we’d have to divide by the number of observations:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">est</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></code></pre></div>
<pre><code>##               No        Yes
## Female 0.1740863 0.04511252
## Male   0.5638112 0.21699003</code></pre>
<p>But then we’d have to generate a mosaic plot if we wanted to display the two dimensions.</p>
<p>It’s easier to just plot the absolute counts:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">est</span> <span class="op">%&gt;%</span> 
  <span class="fu">as_tibble</span><span class="op">(</span>rownames <span class="op">=</span> <span class="st">"level"</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">pivot_longer</span><span class="op">(</span><span class="op">-</span><span class="va">level</span>, names_to <span class="op">=</span> <span class="st">"member"</span>, values_to <span class="op">=</span> <span class="st">"n"</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_col</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span><span class="va">level</span>, <span class="va">n</span>, fill <span class="op">=</span> <span class="va">member</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme_minimal</span><span class="op">(</span>base_family <span class="op">=</span> <span class="st">"Lato"</span><span class="op">)</span></code></pre></div>
<p><img src="RDS-tut_files/figure-html/unnamed-chunk-5-1.png" width="700" style="display: block; margin: auto;"></p>
</div>
<div id="run-diagnostics-again" class="section level1">
<h1 class="hasAnchor">
<a href="#run-diagnostics-again" class="anchor"></a>Run Diagnostics (again)</h1>
<p>Because of the way RDS works, standard errors and design effect estimates <em>alone</em> do not tell the whole story about the accuracy of your estimates as you’d expect from any other survey. Two heuristics were developed to capture part of the uncertainty beyond the data.</p>
<div id="convergence-plots" class="section level2">
<h2 class="hasAnchor">
<a href="#convergence-plots" class="anchor"></a>Convergence Plots</h2>
<p>Convergence plots help to determine whether the final RDS estimate is biased by the initial convenience sample of seeds. If the estimates shown in the plots do not level off as the sample size increases then the current estimate is probably biased by the choice of seeds. It is recommended to create a convergence plot of all traits of interest during the research process and extend sampling if the estimate has not stabilized.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/convergence.plot.html">convergence.plot</a></span><span class="op">(</span><span class="va">data</span>, outcome.variable <span class="op">=</span> <span class="st">"Union.yn."</span><span class="op">)</span></code></pre></div>
<p><img src="RDS-tut_files/figure-html/convergence-1.png" width="700" style="display: block; margin: auto;"></p>
<p>This shows that the sample estimate has successfully converged to the true prevalence rate in the population.</p>
</div>
<div id="bottleneck-plots" class="section level2">
<h2 class="hasAnchor">
<a href="#bottleneck-plots" class="anchor"></a>Bottleneck Plots</h2>
<p>Bottleneck plots, on the other hand, are used to asses whether the population of interest contains distinct sub-communities that could bias the RDS estimate. If the sub-communities tend to recruit from within (i.e. exhibit homophily) then the choice of seeds may generate a biased sample. If the sub-communities are different with respect to the population characteristic of interest then the RDS prevalence estimate may also be biased.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/bottleneck.plot.html">bottleneck.plot</a></span><span class="op">(</span><span class="va">data</span>, outcome.variable <span class="op">=</span> <span class="st">"Union.yn."</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "1"
## [1] "2"
## [1] "3"
## [1] "4"
## [1] "5"
## [1] "6"
## [1] "7"
## [1] "8"
## [1] "18"
## [1] "53"
## [1] "187"
## [1] "191"
## [1] "200"</code></pre>
<p><img src="RDS-tut_files/figure-html/bottleneck-1.png" width="700" style="display: block; margin: auto;"></p>
<p>Each line here represents the recruitment chain starting from a given seed. If the RDS sample were truly representative of the overall population, then all the lines would have converged around the sample estimate. Seeing as that is not the case here, the estimates for union membership from this survey cannot be taken as reliable estimates of union membership in the overall population.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Mark S. Handcock, Krista J. Gile, Ian E. Fellows, W. Whipple Neely.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>

<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Compute a test of trend in prevalences based on a likelihood-ratio statistic — LRT.trend.test • RDS</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/yeti/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Compute a test of trend in prevalences based on a likelihood-ratio statistic — LRT.trend.test" />
<meta property="og:description" content="This function takes a series of point estimates and their associated standard errors and
computes the p-value for the test of a monotone decrease in the 
population prevalences (in sequence order). 
The p-value for a monotone increase is
also reported. An optional plot of the estimates and the null distribution of the test statistics is provided.
More formally, let the \(K\) population prevalences in sequence order be \(p_1, \ldots, p_K\).
We test the null hypothesis:
$$H_0 : p_1 = \ldots = p_K$$
vs
$$H_1 : p_1 \ge p_2 \ldots \ge p_K$$
with at least one equality strict. The alternatie hypothesis is for a monotone decreasing trend.
A likelihood ratio statistic for this test has 
been derived (Bartholomew 1959).
The null distribution of the likelihood ratio statistic is very complex 
but can be determined by a simple Monte Carlo process.
Alternatively, we can test the null hypothesis:
$$H_0 : p_1 \ge p_2 \ldots \ge p_K$$
vs
$$H_1 : \overline{H_0}$$
The null distribution of the likelihood ratio statistic is very complex 
but can be determined by a simple Monte Carlo process.
In both cases we also test for:
$$H : p_1 \le p_2 \ldots \le p_K$$
that is, a monotonically increasing trend.
The function requires the isotone library." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">RDS</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.9-2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/How-to.html">Tutorial How to start</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/ifellows/RDS/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Compute a test of trend in prevalences based on a likelihood-ratio statistic</h1>
    <small class="dont-index">Source: <a href='https://github.com/ifellows/RDS/blob/master/R/LRT.trend.R'><code>R/LRT.trend.R</code></a></small>
    <div class="hidden name"><code>LRT.trend.test.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function takes a series of point estimates and their associated standard errors and
computes the p-value for the test of a monotone decrease in the 
population prevalences (in sequence order). 
The p-value for a monotone increase is
also reported. An optional plot of the estimates and the null distribution of the test statistics is provided.
More formally, let the \(K\) population prevalences in sequence order be \(p_1, \ldots, p_K\).
We test the null hypothesis:<br />
$$H_0 : p_1 = \ldots = p_K$$
vs
$$H_1 : p_1 \ge p_2 \ldots \ge p_K$$
with at least one equality strict. The alternatie hypothesis is for a monotone decreasing trend.
A likelihood ratio statistic for this test has 
been derived (Bartholomew 1959).
The null distribution of the likelihood ratio statistic is very complex 
but can be determined by a simple Monte Carlo process.<br />
Alternatively, we can test the null hypothesis:<br />
$$H_0 : p_1 \ge p_2 \ldots \ge p_K$$
vs
$$H_1 : \overline{H_0}$$
The null distribution of the likelihood ratio statistic is very complex 
but can be determined by a simple Monte Carlo process.
In both cases we also test for:<br />
$$H : p_1 \le p_2 \ldots \le p_K$$
that is, a monotonically increasing trend.
The function requires the isotone library.</p>
    </div>

    <pre class="usage"><span class='fu'>LRT.trend.test</span><span class='op'>(</span>
  <span class='va'>data</span>,
  variables <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>data</span><span class='op'>)</span>,
  null <span class='op'>=</span> <span class='st'>"monotone"</span>,
  confidence.level <span class='op'>=</span> <span class='fl'>0.95</span>,
  number.of.bootstrap.samples <span class='op'>=</span> <span class='fl'>5000</span>,
  plot <span class='op'>=</span> <span class='cn'>NULL</span>,
  seed <span class='op'>=</span> <span class='fl'>1</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>data</th>
      <td><p>A two row matrix or data.frame of prevalence estimates and
their standard errors. The first row is the prevalence estimates and the
second are the standard errors. The column are the comparison groups in the
order (e.g., time) there are to be assessed. The row names of <code>data</code>
should be "estimate" and "sigma". This is</p></td>
    </tr>
    <tr>
      <th>variables</th>
      <td><p>A character vector of column names it select from <code>data</code>.</p></td>
    </tr>
    <tr>
      <th>null</th>
      <td><p>A character string indicating the null hypothesis to use. The value <code>"monotone"</code> uses the various 
monotone hypotheses as the nulls. If not <code>"monotone"</code>, the null is chosen to be that of equality of the means
over all periods.</p></td>
    </tr>
    <tr>
      <th>confidence.level</th>
      <td><p>The confidence level for the confidence intervals. The default is 0.95 for 95%.</p></td>
    </tr>
    <tr>
      <th>number.of.bootstrap.samples</th>
      <td><p>The number of Monte Carlo draws to
determine the null distribution of the likelihood ratio statistic.</p></td>
    </tr>
    <tr>
      <th>plot</th>
      <td><p>A character vector of choices, a subset of <code>estimates</code>, <code>distributions</code>.
If <code>estimates</code> is given then a plot of the estimates and nominal 95% confidence bands (as error bars) is produced.
If <code>distributions</code> is given then a plot is produced of the null distributions of 
the likelihood
ratio statistic with the observed likelihood ratio statistics plotted as a vertical dashed line.</p></td>
    </tr>
    <tr>
      <th>seed</th>
      <td><p>The value of the random number seed. Preset by default to allow reproducibility.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A list with components</p><ul>
<li><p><code>pvalue.increasing</code>: The p-value for the test of a monotone increase in population prevalence.</p></li>
<li><p><code>pvalue.decreasing</code>: The p-value for the test of a monotone decrease in population prevalence.</p></li>
<li><p><code>L</code>: The value of the likelihood-ratio statistic.</p></li>
<li><p><code>x</code>: The passed vector of prevalence estimates in the order (e.g., time).</p></li>
<li><p><code>sigma</code> The passed vector of standard error estimates corresponding to <code>x</code>.</p></li>
</ul>

    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Bartholomew, D. J. (1959). A test of homogeneity for ordered alternatives. Biometrika 46 36-48.</p>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Mark S. Handcock</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='va'>d</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/t.html'>t</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>estimate<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.16</span>,<span class='fl'>0.15</span>,<span class='fl'>0.3</span><span class='op'>)</span>, sigma<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.04</span>,<span class='fl'>0.04</span>,<span class='fl'>0.1</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>d</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"time_1"</span>,<span class='st'>"time_2"</span>,<span class='st'>"time_3"</span><span class='op'>)</span> 
<span class='fu'>LRT.trend.test</span><span class='op'>(</span><span class='va'>d</span>,number.of.bootstrap.samples<span class='op'>=</span><span class='fl'>1000</span><span class='op'>)</span>
</div><div class='output co'>#&gt; In a test of the null hypothesis of an increasing trend in proportions against the complementary hypothesis, the p-value is 0.483.
#&gt; We do not reject the null hypothesis of an increasing trend (at the 5% level).
#&gt; 
#&gt; In a test of the null hypothesis of an decreasing trend in proportions against the complementary hypothesis, the p-value is 0.187.
#&gt; We do not reject the null hypothesis of an decreasing trend (at the 5% level).
#&gt; 
#&gt; In a test of the null hypothesis of a monotone trend in proportions against the complementary hypothesis, the p-value is 0.199.
#&gt; We do not reject the null hypothesis of a monotone trend (at the 5% level).
#&gt; </div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Mark S. Handcock, Krista J. Gile, Ian E. Fellows, W. Whipple Neely.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


